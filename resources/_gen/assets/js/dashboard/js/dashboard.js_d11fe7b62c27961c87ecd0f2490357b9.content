(function(){let main=document.querySelector("main");let tabLinks=document.querySelectorAll(".tabs__controls");tabLinks.forEach((tabLink)=>{tabLink.addEventListener("click",checkMode,false);});let toggles=document.querySelectorAll("#metaToggle .btns__btn");let radios=document.querySelectorAll("#metaToggle input");toggles.forEach((toggle)=>{toggle.addEventListener("click",switchChecked,false);function switchChecked(e){let thisRadio=e.target.parentElement.querySelector("input");radios.forEach((radio)=>{if(radio===thisRadio){radio.checked=true;}else{radio.checked=false;}});checkMode();}});window.addEventListener("DOMContentLoaded",function(){checkMode();});function checkMode(){console.log("run checked mode");radios.forEach((radio)=>{if(radio.checked===true){main.classList.add("mode-"+radio.name);if(radio.name==="google"){mode="google";getLinks(mode);}else if(radio.name==="social"){mode="social";getLinks(mode);}}else{main.classList.remove("mode-"+radio.name);}});}
function ajaxGetContent(linkSrc,link,mode){fetch(linkSrc).then((response)=>response.text()).then((html)=>{let parser=new DOMParser();var doc=parser.parseFromString(html,"text/html");var head=doc.querySelector('head');(function(){let pageTitle=head.querySelector("title");let metaTitle=head.querySelector('[name="title"]').innerHTML;let metas=head.querySelectorAll("meta");metas.forEach(function(meta,index){let name=meta.getAttribute("name");let property=meta.getAttribute("property");let content=meta.getAttribute("content");if(name&&content){getMetaContentByProperty(name,content,link);}else if(property&&content){getMetaContentByProperty(property,content,link);}});})();function getMetaContentByName(name,content){}
function getMetaContentByProperty(property,content,link){if(property.match(/image/)){setPreviewImage(content);}
function setPreviewImage(){link.querySelector(".metaBgImage").style.backgroundImage=`url('${content}')`;}}}).catch((error)=>{console.warn(error);});}
function getLinks(mode){console.log("mode",mode);let openTab=document.querySelector(".tabs__panel--selected");let links=openTab.querySelectorAll("a");links.forEach(function(link,index){let linkSrc=link.href;ajaxGetContent(linkSrc,link,mode);});}})();